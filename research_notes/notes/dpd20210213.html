<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>dpd20210213</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
  body {
    padding: 2cm; 
  }
}
</style>


</head>

<body>

<h4 id="toc_0"><a href="../../index.html">HOME</a> <a href="../index.html">CONTENTS</a></h4>

<h2 id="toc_1">Parameters in DPD (Dissipative Particle Dynamics) model and the units conversion</h2>

<p><em>by Yawei Liu  @Sydney, Australia 2020/01/16</em></p>

<h3 id="toc_2">DPD model</h3>

<p>In the DPD model, one DPD bead represents \(N_m\) fluid (e.g. water) molecules. Here, \(N_m\) is also called coarse-graining (CG) degree. The DPD beads interact with each other via a conservative force \(\textbf{F}_{ij}^C\), a dissipative force  \(\textbf{F}_{ij}^D\) and a random force \(\textbf{F}_{ij}^R\) given by
\[\begin{eqnarray}
\textbf{F}_{ij}^C &amp;=&amp; A (1-r_{ij}/r_c) \textbf{e}_{ij} &amp;&amp; r_{ij}&lt;r_c \\ 
\textbf{F}_{ij}^D &amp;=&amp; -\gamma(1-r_{ij}/r_c)^2 (\textbf{e}_{ij} \cdot \textbf{v}_{ij}) \textbf{e}_{ij} &amp;&amp;r_{ij}&lt;r_c \\
\textbf{F}_{ij}^R &amp;=&amp; \xi (1-r_{ij}/r_c) \theta_{ij} (\Delta t)^{-1/2} \textbf{e}_{ij} &amp;&amp; r_{ij}&lt;r_c
\end{eqnarray}\]
between bead \(i\) and \(j\).</p>

<ul>
<li>\(r_{ij}=|\textbf{r}_{ij}|\): the centre-to-centre distance between the two beads.</li>
<li>\(\textbf{e}_{ij}=\textbf{r}_{ij}/r_{ij}\): the direction vector pointing between the two beads.</li>
<li>\(\textbf{v}_{ij}\): the vector difference in velocities between the two beads.</li>
<li>\(A\): the repulsion coefficient.</li>
<li>\(\gamma\): the dissipative coefficient.</li>
<li>\(\xi\): the the noise strength, and \(\xi=\sqrt{2k_BT\gamma}\) with \(k_B\) the Boltzmann constant and \(T\) the temperature.</li>
<li>\(\theta_{ij}\): a Gaussian white noise variable.</li>
<li>\(\Delta t\): the simulation time step.</li>
<li>\(r_c\): the cutoff distance, and also can be treated as the size (diameter) of the DPD bead.</li>
</ul>

<h3 id="toc_3">Determining paramters</h3>

<ul>
<li>\(r_c\), \(k_BT\), \(m\) (bead mass) and \(\tau\) (time)
In simulations, the reduced units are often used. For DPD model, all units are often scaled by the length unit \(r_c\), the mass unit \(m\), the energy unit \(k_BT\), and the time unit \(\tau\). Hence, \(r_c^* = m^* = (k_BT)^* =\tau^* =1\) in the simulations. The superscript asterisk (\(^*\)) means the quality is in reduced units. Units of other quantities are from these four basic units. For example, the unit for the mass density is \(m/r_c^3\), the unit for the diffusion constant is \(r_c^2/\tau\).</li>
<li>\(\rho\) (density)
The DPD simulations are normally carried out within a \(NVT\) ensemble, and the number of particles are often determined by setting \(\rho^*=3\). When \(\rho^*&gt;2\), a simple scaling relation between the density and excess pressure exits\(^1\). In principle the density chosen for the simulation is a free parameter, but for efficiency reasons one would thus choose the lowest possible density where the scaling relation still holds.</li>
<li>\(A\) and \(N_m\)
In order to match the compressibility of DPD fluid with a liquid having the dimensionless compressibility of \(\Psi\), the interparticle repulsion coefficient \(A\) is given by 
\[A\approx \frac{\Psi N_m -1}{0.2\rho^*}(k_BT)^*.\]
For water, \(\Psi\approx 16\) yields \(A^*=25\) for \(N_m=1\) and \(A^*=104\) for \(N_m=4\).</li>
<li><p>\(\gamma\) and \(\Delta t\)
As a reasonable compromise between fast temperature equilibration, a fast simulation and a stable, physically meaningful system, simulation with \(\Delta t^*=0.04\) and \(\gamma^*=4.5\) is often recommended.
However, above choice for \(\Delta t\) and \(\gamma\) yields very small Schmidt number (i.e. the ratio of viscosity to diffusion) (\(Sc\sim1\)) compared to the real fluid such as water (\(Sc\sim10^3\)). A possible solution to this problem is increasing \(\gamma\). At the same time though, \(\Delta t\) would have to be reduced to maintain the temperature control.</p></li>
<li><p><strong>There is no unique way to determine the parameters for DPD model.</strong> For a given physical problem, with a characteristic length scale, we may always put a given number of DPD particles and parametrize the model in order to recover some macroscopic information (e.g. compressibilities, viscosity and diffusion constant).</p></li>
</ul>

<h3 id="toc_4">Units  conversion</h3>

<p>The conversion between DPD units (\(r_c\), \(k_BT\), \(m\) and \(\tau\)) and real units ([m], [J], [kg] and [s]) is obtained from the key macroscopic information recovered by the model. If quantities in DPD units are labeled with \(_{sim}\) and in real units are labeled with \(_{real}\), one would have</p>

<ul>
<li>\(m=N_m M_{real}/N_A\) with \(M_{real}\) the mole mass of the fluid (e.g. water) and \(N_A\) the Avogadro constant.</li>
<li>\(r_c=(m\rho_{sim}/\rho_{real})^{1/3}\) with \(\rho_{real}\) the mass density of the fluid.</li>
<li>\(k_BT = k_B \cdot T\) with \(k_B=1.38064853e-23\) J\(\cdot\)K and \(T\) is the system temperature in K.</li>
<li>The time unit \(\tau\) can be chosen in different ways.

<ul>
<li>By taking the long-term self-diffusion constant into account, \(\tau=N_m r_c^2 D_{sim}/D_{real}\) with \(D\) the diffusion constant. Sometimes, this relation is also used to determine \(N_m\).</li>
<li>If the viscous processes are the main parts, then \(\tau=r_c^2 \nu_{sim}/\nu_{real}\) with \(\nu\) the kinematic viscosity.</li>
<li>Or \(\tau=r_c/U_{ref}\) in which the reference velocity \(U_{ref}\) is chosen as either system thermal velocity \((k_BT/m)^{1/2}\) or the characteristic velocity of the real flow.</li>
</ul></li>
</ul>

<h3 id="toc_5">Example</h3>

<p>A NVT simulation with 1000 DPD beads in a cubic box is carried out by LAMMPS. The parameters are: \(\rho^*=3\); \(A=104\) for \(N_m=4\); \(\gamma=100\); \(\Delta t=0.005\). Then, by comparing the DPD fluid with the water at \(T=298\) K, we have:</p>

<ul>
<li>Mass \(m=1.1969\times10^{-25}\) kg (\(m=N_m M_{real}/N_A\))</li>
<li>Length \(r_c=7.1125\times10^{-10}\) m (\(r_c=(m\rho_{sim}/\rho_{real})^{1/3}\))</li>
<li>Energy \(k_BT = 4.1143\times10^{-21}\) J (\(k_BT = k_B \cdot T\))</li>
<li>Time \(\tau = 3.8363\times10^{-12}\) s (\(\tau=r_c\sqrt{m/k_BT}\) )</li>
</ul>

<p>As a results, the kinematic viscosity for the DPD fluid is \(\nu=1.569 r_c^2/\tau = 2.069\times10^{-7}\) m\(^2\)/s (\(\nu=8.935\times10^{-7}\) [m\(^2\)/s] for water).</p>

<h3 id="toc_6">References</h3>

<p>(1) <a href="http://aip.scitation.org/doi/10.1063/1.474784">Groot, R. D.; Warren, P. B. Dissipative Particle Dynamics: Bridging the Gap between Atomistic and Mesoscopic Simulation. J. Chem. Phys. 1997, 107 (11), 4423–4435.</a></p>

<h2 id="toc_7"></h2>

<h4 id="toc_8"><a href="../../index.html">HOME</a> <a href="../index.html">CONTENTS</a></h4>



<script type="text/x-mathjax-config">
(function () {

MathJax.Hub.Config({
	'showProcessingMessages': false,
	'messageStyle': 'none'
});

if (typeof MathJaxListener !== 'undefined') {
	MathJax.Hub.Register.StartupHook('End', function () {
		MathJaxListener.invokeCallbackForKey_('End');
	});
}

})();
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


</body>

</html>
