<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>20210530_Dynamics simulations of self-assembly of nanoparticles (Tutorial VII_Visualizing simulation system)</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
  body {
    padding: 2cm; 
  }
}
</style>


</head>

<body>

<h4 id="toc_0"><a href="../../index.html">HOME</a> <a href="../index.html">CONTENTS</a></h4>

<h2 id="toc_1">Dynamics simulations of self-assembly of nanoparticles (Tutorial VII: Visualizing simulation system)</h2>

<p><em>by Yawei Liu  @ Sydney, Australia 2021/05/30</em></p>

<p>In the simulations, we save the positions (\(x,y,z\)) and orientations (\(\mu_x,\mu_y,\mu_z\)) of the special sphere in each rods in <code>result_atoms.log</code> file, as shown below:</p>

<div><pre><code class="language-none">ITEM: TIMESTEP
0
ITEM: NUMBER OF ATOMS
1080
ITEM: BOX BOUNDS pp pp pp
-1.1774184599270537e+01 1.1774184599270537e+01
-1.1329713887893588e+01 1.1329713887893588e+01
-1.1774184599270537e+01 1.1774184599270537e+01
ITEM: ATOMS id mol type x y z mux muy muz
1 1 1 6.52798 -4.66256 -0.313528 0.568254 -0.820304 -0.0647147
12 2 1 -2.33249 -3.56186 2.07013 -0.139812 0.73499 -0.663507
23 3 1 1.33257 0.510454 9.1816 0.114889 0.557617 -0.822109
34 4 1 -5.6695 -5.62791 -8.45804 -0.546225 -0.408355 0.731358
45 5 1 10.3018 -5.92995 11.421 -0.955831 -0.230191 -0.182756
56 6 1 11.273 -9.62742 10.5093 0.161756 0.980883 0.10818
67 7 1 10.9102 -6.33117 9.96562 -0.896238 -0.440009 -0.0561227
78 8 1 -8.28074 -10.6135 0.445832 0.661023 0.628934 -0.409256
...</code></pre></div>

<p>We define a Python class called <code>Snapshots</code> to read this file:</p>

<div><pre><code class="language-none">class Snapshots():
    def __init__(self,filename):
        self.filename = filename
        self.snap_number = None
        self.lines = []
        frames = []
        
        with open(filename,&#39;r&#39;) as f:
            index = 0
            for i,line in enumerate(f):
                self.lines.append(line)
                if line.strip() == &quot;ITEM: TIMESTEP&quot;:
                    index = 0
                    first_line = i
                else:
                    index += 1
                    if index == 1:
                        timestep = int(line.strip())
                    elif index == 3:
                        atom_number = int(line.strip())
                        last_line = first_line + 8 + atom_number
                    elif index == 5:
                        line = re.split(r&#39;\s+&#39;,line.strip())
                        xlo, xhi = list(map(float,line[-2:]))
                    elif index == 6:
                        line = re.split(r&#39;\s+&#39;,line.strip())
                        ylo, yhi = list(map(float,line[-2:]))
                    elif index == 7:
                        line = re.split(r&#39;\s+&#39;,line.strip())
                        zlo, zhi = list(map(float,line[-2:]))
                    elif index &gt; 8 and index == atom_number+8:
                        frame = [timestep, atom_number, xlo, xhi, ylo, yhi, zlo, zhi, first_line, last_line]
                        frames.append(frame)
        self.snapN = len(frames)
        columns = &#39;timestep solid_atom_number xlo xhi ylo yhi zlo zhi first_line last_line&#39;.split(&#39; &#39;)
        dtypes = [int,int,float,float,float,float,float,float,int,int]
        frames = pd.DataFrame(data=frames,columns=columns)
        self.frames = frames.astype(dict(zip(columns,dtypes)))</code></pre></div>

<p>Running <code>rawsnaps = Snapshots(&#39;./results_atoms.log&#39;)</code>, all data in <code>result_atoms.log</code> will be saved in <code>rawsnaps</code> which has a variable <code>snapN</code> representing the number of snapshots in the file.</p>

<p>We define another Python classes to read a specified snapshot in <code>rawsnaps</code>.</p>

<div><pre><code class="language-none">class Snapshot():
    def __init__(self,body,snaps,snap_id):
        self.body = body

        frame = snaps.frames.iloc[snap_id]
        self.timestep = frame[&#39;timestep&#39;]
        
        #box
        xlo,xhi = frame[[&#39;xlo&#39;,&#39;xhi&#39;]]
        ylo,yhi = frame[[&#39;ylo&#39;,&#39;yhi&#39;]]
        zlo,zhi = frame[[&#39;zlo&#39;,&#39;zhi&#39;]]
        Lx,Ly,Lz = [xhi-xlo,yhi-ylo,zhi-zlo]        
        self.box = freud.box.Box(Lx,Ly,Lz)
        
        #rebuild bodys
        first_line = int(frame[&#39;first_line&#39;] + 9) #lammps dump custom has 9 lines before atom info.
        last_line = int(frame[&#39;last_line&#39;])
        self.atoms = None
        self.bodys = None
        self._build_bodys(snaps,first_line,last_line)
        self.bodyN = len(self.bodys)
        
        self.global_nematic_order = None
        self.n = None
        self.c = None
        
        self.global_smectic_order = None
        
    def _perpendicular_vector(self,v):
            if not v[0] and not v[1]:
                if not v[2]:
                    raise ValueError(&#39;zero vector&#39;)
                return np.array([0, 1, 0])
            return np.array([-v[1], v[0], 0])
        
    def _build_bodys(self,snaps,first_line,last_line):
        columns = &#39;id mol type x y z mux muy muz&#39;.split(&#39; &#39;)
        dtypes = [int,int,int,float,float,float,float,float,float]
        self.atoms = pd.DataFrame(data=[re.split(r&#39;\s+&#39;,line.strip()) for line in\
                                   snaps.lines[first_line:last_line+1]],columns=columns)
        self.atoms = self.atoms.astype(dict(zip(columns,dtypes)))

        mol = self.atoms[&#39;mol&#39;]
        u, indices, count = np.unique(mol, return_inverse=True, return_counts= True)
        #atomN = count[indices][self.atoms[&#39;type&#39;]==1]
        ###compress mol ID from ID = 0
        self.atoms[&#39;mol&#39;] = np.arange(len(u))[indices]

        origins = self.atoms[self.atoms[&#39;type&#39;]==1]
        tails = self.atoms[self.atoms[&#39;type&#39;]==2]
        xs = origins[[&#39;x&#39;,&#39;y&#39;,&#39;z&#39;]].values
        us = origins[[&#39;mux&#39;,&#39;muy&#39;,&#39;muz&#39;]].values
        if tails.empty:
            vs = np.array([self._perpendicular_vector(us[i]) for i in range(len(us))])
        else:
            vs = tails[[&#39;mux&#39;,&#39;muy&#39;,&#39;muz&#39;]].values
        
        qs = [R.align_vectors([us[i],vs[i]],[[1.,0,0],[0,1.,0]])[0].as_quat() for i in range(len(us))]
        
        #prime axis of the orentation
        r = R.from_quat(qs)
        us = r.apply(self.body.u)
        vs = r.apply(self.body.v)
        
        #remain the center of body in the box
        cms = xs+r.apply(self.body.cm)
        cms = self.box.wrap(cms)
        #cms -= (cms/self.box.L+np.sign(cms)/2.).astype(int)*self.box.L
        
        bodys = np.concatenate((cms, us, vs, qs), axis=1)   

   
        columns = &#39;cmx cmy cmz mux muy muz cx cy cz qx qy qz qw&#39;.split(&#39; &#39;)
        dtypes = [float,float,float,float,float,float,float,float,float,float,float,float,float]
        self.bodys = pd.DataFrame(data=bodys,columns=columns)
        self.bodys.astype(dict(zip(columns,dtypes)))
        
    def _compute_global_nematic_order(self):
        us = self.bodys[[&#39;mux&#39;,&#39;muy&#39;,&#39;muz&#39;]].values
        delta = np.diagflat([1,1,1])
        f = lambda x: 3./2.*x[:,None]*x-1./2.*delta
        Q = np.sum(np.apply_along_axis(f, 1, us),axis=0)/len(us)
        w,v = np.linalg.eig(Q)
        self.global_nematic_order = np.amax(w)
        self.n =  np.array(v[:,np.argmax(w)])
        self.c = np.array(v[:,np.argmin(w)])
        
    def _compute_global_smectic_order(self,H):
        tau_real = 0
        tau_image = 0
        if not self.global_nematic_order: self._compute_global_nematic_order()
        tmp = np.dot(self.bodys[[&#39;cmx&#39;,&#39;cmy&#39;,&#39;cmz&#39;]].values,self.n) / H * 2 * np.pi
        tau_real = np.mean(np.cos(tmp))
        tau_image = np.mean(np.sin(tmp))
        self.global_smectic_order = np.sqrt(tau_real**2.+tau_image**2)</code></pre></div>

<p>Running following codes</p>

<div><pre><code class="language-none">snap = Snapshot(body, rawsnaps, 1000)
print(&quot;Timesteps:        %d&quot; % snap.timestep)
print(&quot;Body Number:      %d&quot; % snap.bodyN)
print(&quot;Box size:         %f %f %f&quot; % (snap.box.Lx, snap.box.Ly, snap.box.Lz))
print(&quot;Volume fraction:  %f&quot; % (snap.bodyN / snap.box.volume * body.volume))</code></pre></div>

<p>we obtain a variable <code>snap</code> which represents the 1000th snapshot in the <code>result_atoms.log</code> and some basic info of this snapshot as follow:</p>

<div><pre><code class="language-none">Timesteps:        10000000
Body Number:      1080
Box size:         23.604961 20.071917 22.549898
Volume fraction:  0.449888</code></pre></div>

<p>The position and orientation of each rods in the systems are saved in a Pandas DataFrame called <code>snap.bodys</code> as shown below</p>

<div><pre><code class="language-none">cmx         cmy         cmz         mux         muy         muz         cx          cy          cz              qx          qy          qz          qw
-2.489921   -3.698112   9.446906    0.602640    0.778787    0.174115    -0.790867   0.611988    1.387779e-17    0.038493    -0.078458   0.438776    0.894337
2.827316    -4.723114   2.749676    0.425819    0.900758    0.085518    -0.904070   0.427385    1.387779e-17    0.022900    -0.036156   0.534587    0.844029
-11.020419  5.022142    6.854266    0.378617    0.834733    -0.399838   -0.910698   0.413073    -1.110223e-16   -0.110632   0.171661    0.530306    0.822842
...     ...     ...     ...     ...     ...     ...     ...     ...     ...     ...     ...     ...     ...
-4.795779   3.265872    -2.369987   -0.056612   -0.909607   -0.411594   0.998069    -0.062117   8.326673e-17    -0.153410   -0.144159   0.712407    -0.669447
-2.739685   8.129457    0.303597    0.169454    -0.905760   -0.388437   0.982946    0.183894    -8.326673e-17   0.126575    0.152451    -0.626124   0.754126
11.059372   5.865652    6.623319    -0.594036   -0.775236   -0.214781   0.793760    -0.608231   1.387779e-17    -0.096867   -0.047810   0.891478    -0.439999</code></pre></div>

<p>Below is a Python code to use <code>Plato</code> to visualise this snapshot </p>

<div><pre><code class="language-none">def _plato_sphere_frame(snap,zoom=1.0,size=(20, 20)):
    Lx = snap.box.L[0];Ly = snap.box.L[1];Lz = snap.box.L[2]
    xy = xz = yz = 0
    colors= [pred]+ [pgreen] + [porange] + [pgrey]*9
    box_prim = draw.Box(Lx=Lx, Ly=Ly, Lz=Lz, width=0.2, color=colors)
    
    bodys = snap.bodys
    atoms = snap.body.atoms-snap.body.cm
    cms = bodys[[&#39;cmx&#39;,&#39;cmy&#39;,&#39;cmz&#39;]].values
    r = R.from_quat(bodys[[&#39;qx&#39;,&#39;qy&#39;,&#39;qz&#39;,&#39;qw&#39;]].values)
    positions = []; colors = []
    for i in range(snap.body.N):
        position = r.apply(atoms[i]) + cms
        positions += list(position)
        colors += [pblue]*len(position)

    sphere_prim = draw.Spheres(
        positions=positions,
        radii=[snap.body.D/2.]*len(positions),
        colors=colors,
        vertex_count=200
        )
    return draw.Scene((sphere_prim, box_prim), zoom=zoom,size=size)</code></pre></div>

<p>Running <code>_plato_sphere_frame(snap,zoom=0.5,size=(30,30)).show()</code>, we obtain
<img src="images/assembly_nanoparticles/snapshot_nematic.png" alt=" " height="300" /></p>

<p>Obviously, it is a nematic phase. This is consistent with the equation of state we plotted last week: at volume fraction of \(\sim0.45\), the system is in nematic phase[1].</p>

<h3 id="toc_2">References</h3>

<p>[1] <a href="https://aip.scitation.org/doi/10.1063/5.0041285">Liu, Y.; Widmer-Cooper, A. A Dissipative Particle Dynamics Model for Studying Dynamic Phenomena in Colloidal Rod Suspensions. J. Chem. Phys. 2021, 154 (10), 104120.</a></p>

<h5 id="toc_3">Github Page / Gitee Page / Subscription</h5>

<p><img src="images/github_yawei.png" alt="github page" width="80" height="80" />
<img src="images/gitee_yawei.png" alt="gitee page" width="80" height="80" />
<img src="images/wechat.png" alt="wechat" width="80" height="80" /></p>

<p>&copy; 2021 Yawei Liu. All content licensed under the <a href="https://creativecommons.org/licenses/by-nc/4.0/legalcode#languages">Creative Commons Attribution-NonCommercial License 4.0 International (CC BY-NC 4.0)</a>.</p>

<h2 id="toc_4"></h2>

<h4 id="toc_5"><a href="../../index.html">HOME</a> <a href="../index.html">CONTENTS</a></h4>



<script type="text/x-mathjax-config">
(function () {

MathJax.Hub.Config({
	'showProcessingMessages': false,
	'messageStyle': 'none'
});

if (typeof MathJaxListener !== 'undefined') {
	MathJax.Hub.Register.StartupHook('End', function () {
		MathJaxListener.invokeCallbackForKey_('End');
	});
}

})();
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


</body>

</html>
